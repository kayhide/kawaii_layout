(function(){$(function(){var e,t,r,a,i,n,o,s,d,u,c,h,l,D,g,y,p,w,f,x,B,C,b,m,S,v,A,F,j;if(l=$("canvas#tumtum")[0]){for(t=10,m=.1,b=.35,x=!1,D=!1,A=new createjs.Stage(l),r=new createjs.Container,B=new createjs.Container,A.addChild(r),h=[],u=Box2D.Common.Math.b2Vec2,i=Box2D.Dynamics.b2BodyDef,a=Box2D.Dynamics.b2Body,s=Box2D.Dynamics.b2FixtureDef,c=Box2D.Dynamics.b2World,d=Box2D.Collision.Shapes.b2PolygonShape,n=Box2D.Collision.Shapes.b2CircleShape,o=Box2D.Dynamics.b2DebugDraw,g=$(l),p=new u(g.data("gravity-x"),g.data("gravity-y")),j=new c(p,!0),e=l.width,F=l.width/e,w=l.height/e,y=new s,y.density=1,function(){var e,t;return e=new i,e.type=a.b2_staticBody,y.shape=new d,t=.1,e.position.Set(F/2,-t),y.shape.SetAsBox(F/2,t),j.CreateBody(e).CreateFixture(y),e.position.Set(-t,100*w/2),y.shape.SetAsBox(t,100*w/2),j.CreateBody(e).CreateFixture(y),e.position.Set(F+t,100*w/2),y.shape.SetAsBox(t,100*w/2),j.CreateBody(e).CreateFixture(y)}(),l.addActors=function(e){var t,a;return a=h.slice().sort(function(e,t){return-(e.radius-t.radius)}),t=a.indexOf(e),r.addChildAt(e.actors[0],t),B.addChildAt(e.actors[1],t)},l.addArt=function(){var t,r,o;return o=Math.random()*(b-m)+m,r=new i,r.type=a.b2_dynamicBody,y.shape=new n(.8*o),r.position.Set(F*(.1+.8*Math.random()),w+Math.random()),t=j.CreateBody(r),t.CreateFixture(y),h.push(t),t.radius=o,t.actors=[new ArtImage(o*e),new Baumkuchen(o*e)],l.addActors(t)},l.addArt10=function(){var e,t,r;for(r=[],e=t=1;10>=t;e=++t)r.push(l.addArt());return r},l.toggleImages=function(){return x=!x,x?(r.remove(),A.addChildAt(B,0)):(A.addChildAt(r,0),B.remove()),x},l.toggleDebug=function(){return D=!D,D&&!this.debugDraw&&(this.debugDraw=new o,this.debugDraw.SetSprite(l.getContext("2d")),this.debugDraw.SetDrawScale(e),this.debugDraw.SetFillAlpha(.3),this.debugDraw.SetLineThickness(1),this.debugDraw.SetFlags(o.e_shapeBit|o.e_jointBit),j.SetDebugDraw(this.debugDraw)),D},l.reset=function(){var e,t,a;for(t=0,a=h.length;a>t;t++)e=h[t],j.DestroyBody(e),r.removeChild(e.actors[0]),B.removeChild(e.actors[1]);return h=[],!1},l.dump=function(){var e,t;return t=function(){var t,r,a;for(a=[],t=0,r=h.length;r>t;t++)e=h[t],a.push({position:{x:e.GetPosition().x,y:e.GetPosition().y},radius:e.radius});return a}(),$("#output").text(JSON.stringify(t))},createjs.Ticker.timingMode=createjs.Ticker.RAF,createjs.Ticker.addEventListener("tick",function(t){var r,a,i,n,o,s,d,u;if(j.Step(1/60,3,3),j.ClearForces(),D)return j.DrawDebugData();for(i=0,o=h.length;o>i;i++)if(a=h[i],d=a.GetPosition(),d&&null!=d.x&&null!=d.y)for(u=a.actors,n=0,s=u.length;s>n;n++)r=u[n],r.x=d.x*e,r.y=d.y*e;return A.update(t)}),v=[],f=C=0,S=t;S>=0?S>C:C>S;f=S>=0?++C:--C)v.push(l.addArt());return v}})}).call(this);