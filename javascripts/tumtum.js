(function(){$(function(){var e,t,a,r,i,n,o,s,d,u,c,h,D,l,g,w,y,b,p,x,B,C,S,f,m,A,v,F,j;if(D=$("canvas#tumtum")[0]){for(t=10,f=50,S=100,x=!1,l=!1,v=new createjs.Stage(D),a=new createjs.Container,B=new createjs.Container,v.addChild(a),h=[],u=Box2D.Common.Math.b2Vec2,i=Box2D.Dynamics.b2BodyDef,r=Box2D.Dynamics.b2Body,s=Box2D.Dynamics.b2FixtureDef,c=Box2D.Dynamics.b2World,d=Box2D.Collision.Shapes.b2PolygonShape,n=Box2D.Collision.Shapes.b2CircleShape,o=Box2D.Dynamics.b2DebugDraw,g=$(D),y=new u(g.data("gravity-x"),g.data("gravity-y")),j=new c(y,!0),e=D.width,F=D.width/e,b=D.height/e,w=new s,w.density=1,function(){var e,t;return e=new i,e.type=r.b2_staticBody,w.shape=new d,t=.1,e.position.Set(F/2,-t),w.shape.SetAsBox(F/2,t),j.CreateBody(e).CreateFixture(w),e.position.Set(-t,b/2),w.shape.SetAsBox(t,b/2),j.CreateBody(e).CreateFixture(w),e.position.Set(F+t,b/2),w.shape.SetAsBox(t,b/2),j.CreateBody(e).CreateFixture(w)}(),D.addActors=function(e){var t,r;return r=h.slice().sort(function(e,t){return-(e.radius-t.radius)}),t=r.indexOf(e),a.addChildAt(e.actors[0],t),B.addChildAt(e.actors[1],t)},D.addArt=function(){var t,a,o;return o=Math.floor(Math.random()*(S-f)+f),a=new i,a.type=r.b2_dynamicBody,w.shape=new n(.8*o/e),a.position.Set(F*(.1+.8*Math.random()),b+Math.random()),t=j.CreateBody(a),t.CreateFixture(w),h.push(t),t.radius=o,t.actors=[new Baumkuchen(o),new ArtImage(o)],D.addActors(t)},D.toggleImages=function(){return x=!x,x?(a.remove(),v.addChildAt(B,0)):(v.addChildAt(a,0),B.remove()),x},D.toggleDebug=function(){return l=!l,l&&!this.debugDraw&&(this.debugDraw=new o,this.debugDraw.SetSprite(D.getContext("2d")),this.debugDraw.SetDrawScale(e),this.debugDraw.SetFillAlpha(.3),this.debugDraw.SetLineThickness(1),this.debugDraw.SetFlags(o.e_shapeBit|o.e_jointBit),j.SetDebugDraw(this.debugDraw)),l},createjs.Ticker.timingMode=createjs.Ticker.RAF,createjs.Ticker.addEventListener("tick",function(t){var a,r,i,n,o,s,d,u;if(j.Step(1/60,3,3),j.ClearForces(),l)return j.DrawDebugData();for(i=0,o=h.length;o>i;i++)if(r=h[i],d=r.GetPosition(),d&&null!=d.x&&null!=d.y)for(u=r.actors,n=0,s=u.length;s>n;n++)a=u[n],a.x=d.x*e,a.y=d.y*e;return v.update(t)}),A=[],p=C=0,m=t;m>=0?m>C:C>m;p=m>=0?++C:--C)A.push(D.addArt());return A}})}).call(this);